set_num_threads(1)
set_memory(4203741184)

set { reference rks }
set { basis cc-pVDZ }

molecule MOL {
    0 1
    noreorient
    nocom
    symmetry c1
    C    0.940800  -0.041500  -0.056200
    C    2.276600  -0.041500  -0.056200
    H    0.380900   0.578300  -0.749400
    H    0.380900  -0.661400   0.637000
    H    2.836500  -0.386833   0.807179
    H    2.836500   0.303927  -0.919613
}

set optking { frozen_dihedral = (" 3 1 2 5 ") }

energy, wfn = energy('B3LYP-D3', return_wfn=True)

import os
os.chdir(os.environ['HTMD_PSI4_WORKDIR'])

oeprop(wfn, 'DIPOLE', 'QUADRUPOLE', 'MULLIKEN_CHARGES')

with open('psi4out.xyz', 'w') as f:
    f.write('6 ' )
    f.write('%.12f\n' % energy)
    f.write(MOL.save_string_xyz())
