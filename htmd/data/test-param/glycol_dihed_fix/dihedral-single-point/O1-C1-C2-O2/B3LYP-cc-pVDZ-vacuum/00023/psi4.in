set_num_threads( 8 )
memory 2.000000 gb

set { reference rks }
set { basis cc-pVDZ }

molecule MOL {
    0 1
    noreorient
    nocom
    symmetry c1
    O    1.141000   0.017000   0.083000
    C    2.558000   0.086000  -0.005000
    C    3.192000  -0.789000   1.067000
    O    2.613302  -2.088180   1.042315
    H    0.789000   0.590000  -0.620000
    H    2.874000   1.128000   0.115000
    H    2.871000  -0.243000  -1.001000
    H    3.042660  -0.348442   2.057729
    H    4.271671  -0.875380   0.900487
    H    3.052233  -2.601560   1.742791
}

set optking { frozen_dihedral = (" 1 2 3 4, 2 3 4 10 ") }

energy, wfn = energy('B3LYP-D3', return_wfn=True)

import os
os.chdir(os.environ['HTMD_PSI4_WORKDIR'])

oeprop(wfn, 'DIPOLE', 'QUADRUPOLE', 'MULLIKEN_CHARGES')

with open('psi4out.xyz', 'w') as f:
    f.write('10 ' )
    f.write('%.12f\n' % energy)
    f.write(MOL.save_string_xyz())
