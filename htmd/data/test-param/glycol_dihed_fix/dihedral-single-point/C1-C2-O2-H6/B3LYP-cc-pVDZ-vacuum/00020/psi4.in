set_num_threads(1)
set_memory(4203741184)

set { reference rks }
set { basis cc-pVDZ }

molecule MOL {
    0 1
    noreorient
    nocom
    symmetry c1
    O    1.141000   0.017000   0.083000
    C    2.558000   0.086000  -0.005000
    C    3.192000  -0.789000   1.067000
    O    4.610000  -0.719000   0.979000
    H    0.789000   0.590000  -0.620000
    H    2.874000   1.128000   0.115000
    H    2.871000  -0.243000  -1.001000
    H    2.876000  -1.830000   0.947000
    H    2.879000  -0.459000   2.064000
    H    4.818344   0.094050   0.486630
}

set optking { frozen_dihedral = (" 2 3 4 10 ") }

energy, wfn = energy('B3LYP-D3', return_wfn=True)

import os
os.chdir(os.environ['HTMD_PSI4_WORKDIR'])

oeprop(wfn, 'DIPOLE', 'QUADRUPOLE', 'MULLIKEN_CHARGES')

with open('psi4out.xyz', 'w') as f:
    f.write('10 ' )
    f.write('%.12f\n' % energy)
    f.write(MOL.save_string_xyz())
